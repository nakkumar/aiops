centos
*******
#!/bin/sh

 cat /var/ossec/logs/alerts/alerts.log | grep 'New Yum package installed.*centos-node' >  /tmp/logfile/sys_centos_after
 msg=$(tail -1 /tmp/logfile/sys_centos_after)
 if  cmp -s /tmp/logfile/sys_centos_after /tmp/logfile/sys_centos_before
 then
         {
             echo "NO NEW LOGS"
             exit 0
     }
else
        {

             cp /tmp/logfile/sys_centos_after /tmp/logfile/sys_centos_before
              echo "System Change Alert --> $msg" | mail -s "Centos AlienVault System Change Alert" admin@zippyops.in
              echo "System Change LOG"

        }

fi


ubuntu
*******
#!/bin/sh

cat /var/ossec/logs/alerts/alerts.log | grep 'New dpkg (Debian Package) installed.*ubuntu-node' >  /tmp/logfile/sys_ubuntu_after
 msg=$(tail -1 /tmp/logfile/sys_ubuntu_after)
 if  cmp -s /tmp/logfile/sys_ubuntu_after /tmp/logfile/sys_ubuntu_before
 then
         {
             echo "NO NEW LOGS"
             exit 0
     }
else
        {

             cp /tmp/logfile/sys_ubuntu_after /tmp/logfile/sys_ubuntu_before
              echo "System Change Alert --> $msg" | mail -s "Ubuntu AlienVault System Change Alert" admin@zippyops.in
              echo "System Change LOG"

        }

fi


windows
*******
#!/bin/sh

cat /var/ossec/logs/alerts/alerts.log | grep 'Application Installed.*windows-2012' >  /tmp/logfile/sys_windows_after
 msg=$(tail -1 /tmp/logfile/sys_windows_after)
 if  cmp -s /tmp/logfile/sys_windows_after /tmp/logfile/sys_windows_before
 then
         {
             echo "NO NEW LOGS"
             exit 0
     }
else
        {

             cp /tmp/logfile/sys_windows_after /tmp/logfile/sys_windows_before
              echo "System Change Alert --> $msg" | mail -s "Windows AlienVault System Change Alert" admin@zippyops.in
              echo "System Change LOG"

        }

fi
